const { PrismaClient } = require('@prisma/client');

const prisma = new PrismaClient();

const samplePolicyContents = {
  'TALENT': `一、政策目标

本政策旨在吸引和培养高层次人才，为地区经济社会发展提供强有力的人才支撑。

二、适用范围

1. 海外高层次人才
2. 国内知名高校博士、硕士
3. 具有丰富实践经验的专业技术人才
4. 创新创业领军人才

三、支持措施

（一）资金支持
- 给予一次性安家费10-50万元
- 提供3年期住房补贴，每月2000-5000元
- 科研启动资金20-100万元

（二）平台支持
- 优先推荐申报各类人才计划
- 提供实验室和办公场所
- 协助组建科研团队

（三）生活保障
- 协助解决配偶就业问题
- 子女入学享受本地户籍待遇
- 提供医疗保健服务

四、申报条件

1. 年龄一般不超过45周岁
2. 具有博士学位或副高级以上职称
3. 在相关领域有突出贡献
4. 身体健康，品行端正

五、申报流程

1. 在线提交申请材料
2. 资格审查
3. 专家评审
4. 公示
5. 签约入职

六、管理服务

建立人才服务专员制度，提供全程跟踪服务，确保各项政策措施落实到位。`,

  'INVESTMENT': `一、政策背景

为进一步优化投资环境，吸引更多优质投资项目落户，制定本投资促进政策。

二、支持对象

1. 符合产业发展方向的投资项目
2. 技术含量高、市场前景好的项目
3. 带动就业能力强的项目
4. 绿色环保型投资项目

三、优惠政策

（一）财政支持
- 固定资产投资补贴：按实际投资额的5-15%给予补贴
- 设备购置补贴：对关键设备给予20-30%的补贴
- 研发费用补贴：按研发投入的10-20%给予补贴

（二）税收优惠
- 企业所得税减免：前三年减半征收
- 增值税优惠：符合条件的可享受即征即退政策
- 土地使用税减免：前五年免征土地使用税

（三）用地支持
- 优先保障项目用地需求
- 工业用地可按最低价格出让
- 支持以租赁方式使用土地

四、申报条件

1. 投资总额不低于1000万元
2. 符合环保要求
3. 技术先进，产品有市场竞争力
4. 承诺在本地注册并纳税

五、办理流程

1. 项目洽谈
2. 签订投资协议
3. 办理相关手续
4. 项目建设
5. 竣工验收
6. 兑现优惠政策

六、服务保障

建立投资项目绿色通道，实行"一站式"服务，确保项目顺利推进。`,

  'STARTUP': `一、政策宗旨

鼓励和支持大众创业、万众创新，营造良好的创新创业生态环境。

二、支持对象

1. 高校毕业生创业项目
2. 科技人员离岗创业项目
3. 返乡农民工创业项目
4. 退役军人创业项目
5. 其他符合条件的创业项目

三、扶持措施

（一）资金扶持
- 创业启动资金：5-20万元无偿资助
- 创业担保贷款：最高300万元，财政贴息
- 房租补贴：入驻孵化器享受3年房租减免

（二）平台支持
- 提供创业孵化基地
- 建设众创空间和科技企业孵化器
- 搭建创业服务平台

（三）培训指导
- 免费创业培训
- 创业导师一对一指导
- 定期举办创业沙龙和路演活动

四、申请条件

1. 创业者年龄18-45周岁
2. 项目具有创新性和市场前景
3. 创业团队结构合理
4. 无不良信用记录

五、申报程序

1. 网上申报
2. 材料审核
3. 现场答辩
4. 专家评审
5. 公示公告
6. 签约扶持

六、跟踪服务

建立创业项目跟踪服务机制，定期回访，及时解决创业过程中遇到的困难和问题。`,

  'INDUSTRY': `一、政策目标

推动产业转型升级，培育壮大新兴产业，提升产业竞争力和可持续发展能力。

二、重点支持产业

1. 高端装备制造业
2. 新一代信息技术产业
3. 生物医药产业
4. 新材料产业
5. 节能环保产业
6. 现代服务业

三、支持政策

（一）项目支持
- 重大产业项目最高补助1000万元
- 技术改造项目按投资额10-20%补助
- 产业链关键环节项目优先支持

（二）平台建设
- 支持建设产业技术研究院
- 鼓励建设公共技术服务平台
- 推动产学研合作平台建设

（三）人才引进
- 产业领军人才最高资助500万元
- 核心技术团队整体引进支持
- 建立人才培养基地

四、申报要求

1. 符合产业发展规划
2. 技术水平国内领先
3. 市场前景广阔
4. 带动效应明显

五、实施程序

1. 发布申报指南
2. 企业申报
3. 形式审查
4. 专家评审
5. 现场核查
6. 批准立项

六、监督管理

建立项目全过程监管机制，确保资金使用规范，项目按期完成，达到预期效果。`
};

async function updatePolicyContent() {
  try {
    console.log('开始更新政策内容...');
    
    // 获取所有政策
    const allPolicies = await prisma.policy.findMany();
    
    // 筛选出内容为空的政策
    const policies = allPolicies.filter(policy => !policy.content || policy.content.trim() === '');

    console.log(`找到 ${policies.length} 个需要更新内容的政策`);

    for (const policy of policies) {
      const content = samplePolicyContents[policy.type] || samplePolicyContents['TALENT'];
      
      await prisma.policy.update({
        where: { id: policy.id },
        data: { 
          content: content,
          summary: content.substring(0, 200) + '...' // 同时更新摘要
        }
      });

      console.log(`已更新政策: ${policy.title}`);
    }

    console.log('政策内容更新完成！');
  } catch (error) {
    console.error('更新政策内容时出错:', error);
  } finally {
    await prisma.$disconnect();
  }
}

updatePolicyContent();